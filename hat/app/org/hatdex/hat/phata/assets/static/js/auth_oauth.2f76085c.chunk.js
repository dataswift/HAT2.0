(this["webpackJsonprumpel-react"]=this["webpackJsonprumpel-react"]||[]).push([[1],{234:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n(0),n(235);var i=n(1),r=function(e){var t=e.type,n=e.children,r=e.fixed,a=e.display;return Object(i.jsx)("div",{children:a&&Object(i.jsx)(i.Fragment,{children:Object(i.jsxs)("div",{className:"notification-banner-container \n            notification-banner-container-".concat(t," \n            ").concat(r?"notification-fixed":null),children:["error"===t&&Object(i.jsx)("i",{className:"material-icons notification-banner-container-icon",children:"warning"}),n]})})})}},235:function(e,t,n){},239:function(e,t,n){"use strict";var i=n(0),r=n(17),a=n(5),c=n(66),o=n(33),d=n(1);t.a=function(e){var t=Object(a.c)();return Object(i.useEffect)((function(){var e=o.parse(window.location.search),n=e.application_id,i=e.name,a=e.redirect_uri,d=e.redirect,l=n||i,s=null===l||void 0===l?void 0:l.toLowerCase();t(a||d?s?Object(r.f)(s):Object(c.g)("application_misconfigured","application_id_is_required "):Object(c.g)("application_misconfigured","redirect_is_required "))}),[t]),Object(d.jsx)(d.Fragment,{children:e.children})}},240:function(e,t,n){"use strict";var i=n(7),r=n(0),a=n(5),c=n(66),o=n(56),d=n(33),l=n(1);t.a=function(e){var t=Object(r.useState)(!1),n=Object(i.a)(t,2),s=n[0],u=n[1],p=Object(a.d)(c.e);Object(r.useEffect)((function(){var e=d.parse(window.location.search),t=e.redirect_uri,n=e.redirect,i=e.fallback,r=e.internal;if(p&&p.error){var a="true"===r,c=function(e,r){var a=t||n;return i||(a?"".concat(a,"?error=").concat(e,"%26error_reason=").concat(r).replace("#","%23"):null)}(p.error,p.errorReason);if(!c)return void u(!0);window.location.href=a&&i||c}}),[p]);var f=function(){return o.a.sandbox?Object(l.jsx)("div",{children:Object(l.jsxs)("div",{className:"app-error",children:[Object(l.jsx)("h3",{className:"app-error-header",children:"Ooops... Looks like something went wrong."}),Object(l.jsxs)("p",{className:"app-error-text",children:['ERROR: App details incorrect. "redirect_uri" query parameter is missing. ',Object(l.jsx)("br",{}),Object(l.jsx)("a",{href:"https://docs.dataswift.io/guides/hat-login/02-send-hat-login",target:"_blank",rel:"noopener noreferrer",children:"Learn more"})]})]})}):Object(l.jsx)("div",{children:Object(l.jsxs)("div",{className:"app-error",children:[Object(l.jsx)("h3",{className:"app-error-header",children:"Ooops... Looks like something went wrong."}),Object(l.jsx)("p",{className:"app-error-text",children:"ERROR: App details incorrect. Please contact the app developer and let them know."})]})})};return Object(l.jsx)(l.Fragment,{children:s?Object(l.jsx)(f,{}):e.children})}},241:function(e,t,n){"use strict";var i=n(0),r=n(5),a=n(17),c=n(66),o=n(34),d=n(60),l=n(33),s=n(1);t.a=function(e){var t=Object(r.d)(c.d),n=Object(r.d)(a.j),u=Object(r.d)(o.f),p=Object(r.d)(d.g),f=Object(r.c)();Object(i.useEffect)((function(){if(n&&n.length>0){var e,t,i=l.parse(window.location.search),r=i.application_id,a=i.name,s=r||a,u=null===s||void 0===s?void 0:s.toLowerCase(),p=n.find((function(e){return e.application.id===u}));if(!p||-1===["App","DataPlug"].indexOf(p.application.kind.kind))return void f(Object(c.g)("application_misconfigured","application_id_not_found "));var v=(null===(e=p.application.dependencies)||void 0===e?void 0:e.plugs)||[],j=(null===(t=p.application.dependencies)||void 0===t?void 0:t.tools)||[];f(Object(o.i)(p)),f(Object(o.g)(n.filter((function(e){return v.indexOf(e.application.id)>-1})))),j.length>0&&f(Object(d.e)())}}),[n,f]),Object(i.useEffect)((function(){if(p&&p.length>0){var e;if(!u)return;var t=(null===(e=u.application.dependencies)||void 0===e?void 0:e.tools)||[];f(Object(o.h)(p.filter((function(e){return-1!==t.indexOf(e.id)}))))}}),[u,p,f]);return t&&0===n.length?Object(s.jsx)("div",{children:Object(s.jsxs)("div",{className:"app-error",children:[Object(s.jsx)("h3",{className:"app-error-header",children:"Looks like something went wrong"}),Object(s.jsx)("p",{className:"app-error-text",children:t}),Object(s.jsx)("button",{className:"btn btn-accent",onClick:function(){f(Object(c.g)("hat_exception","internal_server_error"))},children:"Back"})]})}):Object(s.jsx)(s.Fragment,{children:e.children})}},242:function(e,t,n){"use strict";var i=n(6),r=n(2),a=n.n(r),c=n(0),o=n(5),d=n(10),l=n(34),s=n(33),u=n(259),p=n(131),f=n(262),v=n(1);t.a=function(e){var t=Object(o.d)(l.f),n=Object(o.d)(l.b),r=Object(o.d)(l.c),j=Object(o.d)(l.e);return Object(c.useEffect)((function(){var e=function(){var e=Object(i.a)(a.a.mark((function e(t){var n,i,r,c,o,l,p,f,v,j,b,h,O,g,m,w,x;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.parse(window.location.search),i=n.redirect_uri,r=n.redirect,c=n.internal,o="true"===c,l=i||r,p=decodeURIComponent(l||""),!o){e.next=8;break}window.location.href=l||"",e.next=18;break;case 8:return f=d.a.getInstance(),e.prev=9,e.next=12,f.appLogin(t.application.id);case 12:null!==(j=e.sent)&&void 0!==j&&null!==(v=j.parsedBody)&&void 0!==v&&v.accessToken&&(b=j.parsedBody.accessToken,h=t.application.setup,O=h.validRedirectUris.includes(p),g={applicationId:t.application.id,date:Object(u.a)(new Date,10)},sessionStorage.setItem("attempted_setup",JSON.stringify(g)),m=null===p||void 0===p?void 0:p.includes("www.dataswift.io/sign-up-login"),w=null!==l&&void 0!==l&&l.includes("?")?"&":"?",x=m?window.location.origin+"/feed":"".concat(null===l||void 0===l?void 0:l.replace("#","%23")).concat(w,"token=").concat(b),O?window.location.href=x:(console.warn("Provided URL is not registered"),f.sendReport("hmi_invalid_redirect_url","".concat(t.application.id,": ").concat(l)).then((function(){window.location.href=x})).catch((function(){window.location.href=x})))),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(9);case 18:case"end":return e.stop()}}),e,null,[[9,16]])})));return function(t){return e.apply(this,arguments)}}();if(t&&t.active&&!t.needsUpdating&&r&&j)e(t);else{var n=sessionStorage.getItem("attempted_setup");if(t&&t.enabled&&n){var c=JSON.parse(n);if(c.applicationId===t.application.id&&Object(p.a)(Object(f.a)(c.date)))return void e(t)}}}),[t,n,r,j]),Object(v.jsx)(v.Fragment,{children:e.children})}},243:function(e,t,n){"use strict";var i=n(6),r=n(2),a=n.n(r),c=n(0),o=n(5),d=n(10),l=n(34),s=n(33),u=n(259),p=n(131),f=n(262),v=n(1);t.a=function(e){var t=Object(o.d)(l.f),n=Object(o.d)(l.b),r=Object(o.d)(l.c);return Object(c.useEffect)((function(){var e=s.parse(window.location.search),c=e.application_id,o=e.name,l=e.redirect_uri,v=e.redirect,j=e.dependencies,b=function(){var e=Object(i.a)(a.a.mark((function e(n){var i,r,c,o,l,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.filter((function(e){return!e.active}))[0],r=h(i.application.id),e.prev=2,c=d.a.getInstance(),null===i||void 0===i||!i.application.id){e.next=9;break}return e.next=7,c.appLogin(i.application.id);case 7:null!==(l=e.sent)&&void 0!==l&&null!==(o=l.parsedBody)&&void 0!==o&&o.accessToken&&(s={applicationId:null===t||void 0===t?void 0:t.application.id,date:Object(u.a)(new Date,10)},sessionStorage.setItem("attempted_setup",JSON.stringify(s)),window.location.href="".concat(i.application.setup.url,"?token=").concat(l.parsedBody.accessToken,"&redirect=").concat(r));case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.log("Setup dependencies errored",e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}(),h=function(e){var t=window.location.href.split("?")[0],i=c||o,r=null===i||void 0===i?void 0:i.toLowerCase(),a=l||v,d=j;if(t+="?application_id=".concat(r,"%26redirect_uri=").concat(a),d){var s=d.split(",").filter((function(t){return t!==e}));s&&s.length>0&&(t+="%26dependencies=".concat(s.join()))}else if(n){var u=n.filter((function(t){return t.application.id!==e})).map((function(e){return e.application.id}));u&&u.length>0&&(t+="%26dependencies=".concat(u.join()))}return t.replace("#","%23")},O=sessionStorage.getItem("attempted_setup");if(t&&n&&n.length>0&&O){var g=JSON.parse(O);if(g.applicationId===t.application.id&&Object(p.a)(Object(f.a)(g.date)))return}t&&t.active&&!r&&b(n)}),[t,n,r]),Object(v.jsx)(v.Fragment,{children:e.children})}},244:function(e,t,n){},259:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(8),r=n(105),a=n(3);function c(e,t){Object(a.a)(2,arguments);var n=Object(i.a)(t);return Object(r.a)(e,6e4*n)}},262:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));Math.pow(10,8);var i=36e5,r=n(3),a=n(8);function c(e,t){Object(r.a)(1,arguments);var n=t||{},i=null==n.additionalDigits?2:Object(a.a)(n.additionalDigits);if(2!==i&&1!==i&&0!==i)throw new RangeError("additionalDigits must be 0, 1 or 2");if("string"!==typeof e&&"[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);var c,o=u(e);if(o.date){var d=p(o.date,i);c=f(d.restDateString,d.year)}if(!c||isNaN(c.getTime()))return new Date(NaN);var l,s=c.getTime(),v=0;if(o.time&&(v=j(o.time),isNaN(v)))return new Date(NaN);if(!o.timezone){var b=new Date(s+v),O=new Date(0);return O.setFullYear(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()),O.setHours(b.getUTCHours(),b.getUTCMinutes(),b.getUTCSeconds(),b.getUTCMilliseconds()),O}return l=h(o.timezone),isNaN(l)?new Date(NaN):new Date(s+v+l)}var o={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},d=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,l=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,s=/^([+-])(\d{2})(?::?(\d{2}))?$/;function u(e){var t,n={},i=e.split(o.dateTimeDelimiter);if(i.length>2)return n;if(/:/.test(i[0])?t=i[0]:(n.date=i[0],t=i[1],o.timeZoneDelimiter.test(n.date)&&(n.date=e.split(o.timeZoneDelimiter)[0],t=e.substr(n.date.length,e.length))),t){var r=o.timezone.exec(t);r?(n.time=t.replace(r[1],""),n.timezone=r[1]):n.time=t}return n}function p(e,t){var n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),i=e.match(n);if(!i)return{year:NaN,restDateString:""};var r=i[1]?parseInt(i[1]):null,a=i[2]?parseInt(i[2]):null;return{year:null===a?r:100*a,restDateString:e.slice((i[1]||i[2]).length)}}function f(e,t){if(null===t)return new Date(NaN);var n=e.match(d);if(!n)return new Date(NaN);var i=!!n[4],r=v(n[1]),a=v(n[2])-1,c=v(n[3]),o=v(n[4]),l=v(n[5])-1;if(i)return function(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}(0,o,l)?function(e,t,n){var i=new Date(0);i.setUTCFullYear(e,0,4);var r=i.getUTCDay()||7,a=7*(t-1)+n+1-r;return i.setUTCDate(i.getUTCDate()+a),i}(t,o,l):new Date(NaN);var s=new Date(0);return function(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(O[t]||(g(e)?29:28))}(t,a,c)&&function(e,t){return t>=1&&t<=(g(e)?366:365)}(t,r)?(s.setUTCFullYear(t,a,Math.max(r,c)),s):new Date(NaN)}function v(e){return e?parseInt(e):1}function j(e){var t=e.match(l);if(!t)return NaN;var n=b(t[1]),r=b(t[2]),a=b(t[3]);return function(e,t,n){if(24===e)return 0===t&&0===n;return n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}(n,r,a)?n*i+6e4*r+1e3*a:NaN}function b(e){return e&&parseFloat(e.replace(",","."))||0}function h(e){if("Z"===e)return 0;var t=e.match(s);if(!t)return 0;var n="+"===t[1]?-1:1,r=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return function(e,t){return t>=0&&t<=59}(0,a)?n*(r*i+6e4*a):NaN}var O=[31,null,31,30,31,30,31,31,30,31,30,31];function g(e){return e%400===0||e%4===0&&e%100!==0}},275:function(e,t,n){"use strict";n.r(t);n(0),n(244);var i=n(239),r=n(241),a=n(242),c=n(243),o=n(240),d=n(5),l=n(34),s=n(104),u=n(20),p=n(66),f=n(234),v=n(29),j=n(1),b=function(){var e=window.location.host,t=Object(d.c)(),n=Object(d.d)(v.b),i=Object(d.d)(l.f),r=Object(d.d)(p.d),a=Object(d.d)(l.b),c=Object(d.d)(l.d);return!i||function(e,t,n){var i,r,a,c,o,d,l=e.active&&!e.needsUpdating,s=e.application.dependencies&&(null===(i=e.application.dependencies)||void 0===i?void 0:i.plugs.length)>0,u=e.application.dependencies&&(null===(r=e.application.dependencies)||void 0===r?void 0:r.tools.length)>0,p=null===t||void 0===t?void 0:t.filter((function(t){var n,i;return-1!==(null===(n=e.application.dependencies)||void 0===n||null===(i=n.plugs)||void 0===i?void 0:i.indexOf(t.application.id))})),f=(null===(a=e.application.dependencies)||void 0===a?void 0:a.plugs)&&(null===p||void 0===p?void 0:p.length)===(null===(c=e.application.dependencies)||void 0===c?void 0:c.plugs.length),v=null===n||void 0===n?void 0:n.filter((function(t){var n,i;return-1!==(null===(n=e.application.dependencies)||void 0===n||null===(i=n.tools)||void 0===i?void 0:i.indexOf(t.id))})),j=(null===(o=e.application.dependencies)||void 0===o?void 0:o.tools)&&(null===v||void 0===v?void 0:v.length)===(null===(d=e.application.dependencies)||void 0===d?void 0:d.tools.length);return l||s&&!f||u&&!j}(i,a,c)?Object(j.jsx)(s.a,{loadingText:"Loading permissions..."}):Object(j.jsxs)("div",{children:[Object(j.jsx)(f.a,{type:"error",display:!!r,fixed:!0,children:Object(j.jsxs)("div",{className:"hat-login-notification",children:[Object(j.jsxs)("p",{children:["An error has occurred, please use the back button to return to the previous page ",Object(j.jsx)("br",{}),"and try confirming again. If this error persists please"," ",Object(j.jsx)("a",{href:"mailto:contact@dataswift.io",className:"link-button",children:"contact us"})]}),Object(j.jsx)("button",{className:"btn btn-accent",onClick:function(){t(Object(p.g)("hat_exception","enabling_application_failed"))},children:"Back"})]})}),Object(j.jsx)("span",{className:"flex-spacer-small"}),i&&Object(j.jsx)(u.d,{parentApp:i.application,email:e,language:n,dependencyTools:c.map((function(e){return e.info.name})),dependencyApps:a.map((function(e){return e.application})),onApproved:function(){return t(Object(p.b)((null===i||void 0===i?void 0:i.application.id)||""))},onRejected:function(){return t(Object(p.c)())}})]})};t.default=function(){return Object(j.jsx)(i.a,{children:Object(j.jsx)(r.a,{children:Object(j.jsx)(a.a,{children:Object(j.jsx)(c.a,{children:Object(j.jsx)(o.a,{children:Object(j.jsx)(b,{})})})})})})}}}]);
//# sourceMappingURL=auth_oauth.2f76085c.chunk.js.map