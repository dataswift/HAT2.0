(this["webpackJsonprumpel-react"]=this["webpackJsonprumpel-react"]||[]).push([[1],{210:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(0),i=t.n(a),r=(t(211),function(e){var n=e.type,t=e.children,a=e.fixed,r=e.display;return i.a.createElement("div",null,r&&i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"notification-banner-container \n            notification-banner-container-".concat(n," \n            ").concat(a?"notification-fixed":null)},"error"===n&&i.a.createElement("i",{className:"material-icons notification-banner-container-icon"},"warning"),t)))})},211:function(e,n,t){},215:function(e,n,t){"use strict";var a=t(0),i=t.n(a),r=t(16),c=t(5),o=t(69),l=t(39);n.a=function(e){var n=Object(c.c)();return Object(a.useEffect)((function(){var e=l.parse(window.location.search),t=e.application_id,a=e.name,i=e.redirect_uri,c=e.redirect,d=t||a,p=null===d||void 0===d?void 0:d.toLowerCase();n(i||c?p?Object(r.f)(p):Object(o.g)("application_misconfigured","application_id_is_required "):Object(o.g)("application_misconfigured","redirect_is_required "))}),[n]),i.a.createElement(i.a.Fragment,null,e.children)}},216:function(e,n,t){"use strict";var a=t(6),i=t(0),r=t.n(i),c=t(5),o=t(69),l=t(58),d=t(39);n.a=function(e){var n=Object(i.useState)(!1),t=Object(a.a)(n,2),p=t[0],s=t[1],u=Object(c.d)(o.e);Object(i.useEffect)((function(){var e=d.parse(window.location.search),n=e.redirect_uri,t=e.redirect,a=e.fallback,i=e.internal;if(u&&u.error){var r="true"===i,c=function(e,i){var r=n||t;return a||(r?"".concat(r,"?error=").concat(e,"%26error_reason=").concat(i).replace("#","%23"):null)}(u.error,u.errorReason);if(!c)return void s(!0);window.location.href=r&&a||c}}),[u]);var f=function(){return l.a.sandbox?r.a.createElement("div",null,r.a.createElement("div",{className:"app-error"},r.a.createElement("h3",{className:"app-error-header"},"Ooops... Looks like something went wrong."),r.a.createElement("p",{className:"app-error-text"},'ERROR: App details incorrect. "redirect_uri" query parameter is missing. ',r.a.createElement("br",null),r.a.createElement("a",{href:"https://docs.dataswift.io/guides/hat-login/02-send-hat-login",target:"_blank",rel:"noopener noreferrer"},"Learn more")))):r.a.createElement("div",null,r.a.createElement("div",{className:"app-error"},r.a.createElement("h3",{className:"app-error-header"},"Ooops... Looks like something went wrong."),r.a.createElement("p",{className:"app-error-text"},"ERROR: App details incorrect. Please contact the app developer and let them know.")))};return r.a.createElement(r.a.Fragment,null,p?r.a.createElement(f,null):e.children)}},217:function(e,n,t){"use strict";var a=t(0),i=t.n(a),r=t(5),c=t(16),o=t(69),l=t(40),d=t(63),p=t(39);n.a=function(e){var n=Object(r.d)(o.d),t=Object(r.d)(c.j),s=Object(r.d)(l.f),u=Object(r.d)(d.g),f=Object(r.c)();Object(a.useEffect)((function(){if(t&&t.length>0){var e,n,a=p.parse(window.location.search),i=a.application_id,r=a.name,c=i||r,s=null===c||void 0===c?void 0:c.toLowerCase(),u=t.find((function(e){return e.application.id===s}));if(!u||-1===["App","DataPlug"].indexOf(u.application.kind.kind))return void f(Object(o.g)("application_misconfigured","application_id_not_found "));var v=(null===(e=u.application.dependencies)||void 0===e?void 0:e.plugs)||[],m=(null===(n=u.application.dependencies)||void 0===n?void 0:n.tools)||[];f(Object(l.i)(u)),f(Object(l.g)(t.filter((function(e){return v.indexOf(e.application.id)>-1})))),m.length>0&&f(Object(d.e)())}}),[t,f]),Object(a.useEffect)((function(){if(u&&u.length>0){var e;if(!s)return;var n=(null===(e=s.application.dependencies)||void 0===e?void 0:e.tools)||[];f(Object(l.h)(u.filter((function(e){return-1!==n.indexOf(e.id)}))))}}),[s,u,f]);return n&&0===t.length?i.a.createElement("div",null,i.a.createElement("div",{className:"app-error"},i.a.createElement("h3",{className:"app-error-header"},"Looks like something went wrong"),i.a.createElement("p",{className:"app-error-text"},n),i.a.createElement("button",{className:"btn btn-accent",onClick:function(){f(Object(o.g)("hat_exception","internal_server_error"))}},"Back"))):i.a.createElement(i.a.Fragment,null,e.children)}},218:function(e,n,t){"use strict";var a=t(4),i=t.n(a),r=t(7),c=t(0),o=t.n(c),l=t(5),d=t(9),p=t(40),s=t(39),u=t(86),f=t(88),v=t(129);n.a=function(e){var n=Object(l.d)(p.f),t=Object(l.d)(p.b),a=Object(l.d)(p.c),m=Object(l.d)(p.e);return Object(c.useEffect)((function(){var e=function(){var e=Object(r.a)(i.a.mark((function e(n){var t,a,r,c,o,l,p,f,v,m,b,g;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.parse(window.location.search),a=t.redirect_uri,r=t.redirect,c=t.internal,o=a||r,!("true"===c)){e.next=7;break}window.location.href=o||"",e.next=17;break;case 7:return l=d.a.getInstance(),e.prev=8,e.next=11,l.appLogin(n.application.id);case 11:(null===(f=e.sent)||void 0===f||null===(p=f.parsedBody)||void 0===p?void 0:p.accessToken)&&(v=f.parsedBody.accessToken,m=n.application.setup,b=-1!==[m.url,m.iosUrl,m.androidUrl,m.testingUrl].indexOf(decodeURI(o||"")),g={applicationId:n.application.id,date:Object(u.a)(new Date,10)},sessionStorage.setItem("attempted_setup",JSON.stringify(g)),b?window.location.href="".concat(null===o||void 0===o?void 0:o.replace("#","%23")).concat(-1!==(null===o||void 0===o?void 0:o.indexOf("?"))?"&":"?","token=").concat(v):(console.warn("Provided URL is not registered"),l.sendReport("hmi_invalid_redirect_url","".concat(n.application.id,": ").concat(o)).then((function(){window.location.href="".concat(null===o||void 0===o?void 0:o.replace("#","%23")).concat(-1!==(null===o||void 0===o?void 0:o.indexOf("?"))?"&":"?","token=").concat(v)})).catch((function(){window.location.href="".concat(null===o||void 0===o?void 0:o.replace("#","%23")).concat(-1!==(null===o||void 0===o?void 0:o.indexOf("?"))?"&":"?","token=").concat(v)})))),e.next=17;break;case 15:e.prev=15,e.t0=e.catch(8);case 17:case"end":return e.stop()}}),e,null,[[8,15]])})));return function(n){return e.apply(this,arguments)}}();if(n&&n.active&&!n.needsUpdating&&a&&m)e(n);else{var t=sessionStorage.getItem("attempted_setup");if(n&&n.enabled&&t){var c=JSON.parse(t);if(c.applicationId===n.application.id&&Object(f.a)(Object(v.a)(c.date)))return void e(n)}}}),[n,t,a,m]),o.a.createElement(o.a.Fragment,null,e.children)}},219:function(e,n,t){"use strict";var a=t(4),i=t.n(a),r=t(7),c=t(0),o=t.n(c),l=t(5),d=t(9),p=t(40),s=t(39),u=t(86),f=t(88),v=t(129);n.a=function(e){var n=Object(l.d)(p.f),t=Object(l.d)(p.b),a=Object(l.d)(p.c);return Object(c.useEffect)((function(){var e=s.parse(window.location.search),c=e.application_id,o=e.name,l=e.redirect_uri,p=e.redirect,m=e.dependencies,b=function(){var e=Object(r.a)(i.a.mark((function e(t){var a,r,c,o,l,p;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.filter((function(e){return!e.active}))[0],r=g(a.application.id),e.prev=2,c=d.a.getInstance(),!(null===a||void 0===a?void 0:a.application.id)){e.next=9;break}return e.next=7,c.appLogin(a.application.id);case 7:(null===(l=e.sent)||void 0===l||null===(o=l.parsedBody)||void 0===o?void 0:o.accessToken)&&(p={applicationId:null===n||void 0===n?void 0:n.application.id,date:Object(u.a)(new Date,10)},sessionStorage.setItem("attempted_setup",JSON.stringify(p)),window.location.href="".concat(a.application.setup.url,"?token=").concat(l.parsedBody.accessToken,"&redirect=").concat(r));case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.log("Setup dependencies errored",e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(n){return e.apply(this,arguments)}}(),g=function(e){var n=window.location.href.split("?")[0],a=c||o,i=null===a||void 0===a?void 0:a.toLowerCase(),r=l||p,d=m;if(n+="?application_id=".concat(i,"%26redirect_uri=").concat(r),d){var s=d.split(",").filter((function(n){return n!==e}));s&&s.length>0&&(n+="%26dependencies=".concat(s.join()))}else if(t){var u=t.filter((function(n){return n.application.id!==e})).map((function(e){return e.application.id}));u&&u.length>0&&(n+="%26dependencies=".concat(u.join()))}return n.replace("#","%23")},h=sessionStorage.getItem("attempted_setup");if(n&&t&&t.length>0&&h){var O=JSON.parse(h);if(O.applicationId===n.application.id&&Object(f.a)(Object(v.a)(O.date)))return}n&&n.active&&!a&&b(t)}),[n,t,a]),o.a.createElement(o.a.Fragment,null,e.children)}},220:function(e,n,t){},260:function(e,n,t){"use strict";t.r(n);var a=t(0),i=t.n(a),r=(t(220),t(215)),c=t(217),o=t(218),l=t(219),d=t(216),p=t(5),s=t(40),u=t(114),f=t(21),v=t(69),m=t(210),b=t(34),g=function(){var e,n,t=window.location.host,a=Object(p.c)(),r=Object(p.d)(b.b),c=Object(p.d)(s.f),o=Object(p.d)(v.d),l=Object(p.d)(s.b),d=Object(p.d)(s.d);return!c||c.active&&!c.needsUpdating||c.application.dependencies&&(null===(e=c.application.dependencies.plugs)||void 0===e?void 0:e.length)!==l.length||c.application.dependencies&&(null===(n=c.application.dependencies.tools)||void 0===n?void 0:n.length)!==d.length?i.a.createElement(u.a,{loadingText:"Loading permissions..."}):i.a.createElement("div",null,i.a.createElement(m.a,{type:"error",display:!!o,fixed:!0},i.a.createElement("div",{className:"hat-login-notification"},i.a.createElement("p",null,"An error has occurred, please use the back button to return to the previous page ",i.a.createElement("br",null),"and try confirming again. If this error persists please"," ",i.a.createElement("a",{href:"mailto:contact@dataswift.io",className:"link-button"},"contact us")),i.a.createElement("button",{className:"btn btn-accent",onClick:function(){a(Object(v.g)("hat_exception","enabling_application_failed"))}},"Back"))),i.a.createElement("span",{className:"flex-spacer-small"}),c&&i.a.createElement(f.e,{hmiType:f.d.login.daas,parentApp:c.application,email:t,language:r,dependencyTools:d.map((function(e){return e.info.name})),dependencyApps:l.map((function(e){return e.application})),onApproved:function(){return a(Object(v.b)((null===c||void 0===c?void 0:c.application.id)||""))},onRejected:function(){return a(Object(v.c)())}}))};n.default=function(){return i.a.createElement(r.a,null,i.a.createElement(c.a,null,i.a.createElement(o.a,null,i.a.createElement(l.a,null,i.a.createElement(d.a,null,i.a.createElement(g,null))))))}}}]);
//# sourceMappingURL=auth_oauth.dfba50d8.chunk.js.map